{
  "finished_at": "2026-01-20T04:54:04.306522Z",
  "meta": {
    "attempt": 1,
    "request_fingerprint": "1f06ea582df4e1c1",
    "tag": "graphql_comments_item2232_pcced28c6"
  },
  "request": {
    "body": {
      "query": "query GetItemCommentsPage($owner: String!, $name: String!, $number: Int!, $after: String) {\n  repository(owner: $owner, name: $name) {\n    issueOrPullRequest(number: $number) {\n      __typename\n      ... on Issue {\n        comments(first: 100, after: $after) {\n          pageInfo { hasNextPage endCursor }\n          nodes {\n            id\n            databaseId\n            url\n            body\n            createdAt\n            updatedAt\n            author {\n              __typename\n              login\n              url\n              avatarUrl\n              ... on User { id databaseId }\n              ... on Organization { id databaseId }\n              ... on Bot { id databaseId }\n              ... on Mannequin { id databaseId }\n            }\n            authorAssociation\n          }\n        }\n      }\n      ... on PullRequest {\n        comments(first: 100, after: $after) {\n          pageInfo { hasNextPage endCursor }\n          nodes {\n            id\n            databaseId\n            url\n            body\n            createdAt\n            updatedAt\n            author {\n              __typename\n              login\n              url\n              avatarUrl\n              ... on User { id databaseId }\n              ... on Organization { id databaseId }\n              ... on Bot { id databaseId }\n              ... on Mannequin { id databaseId }\n            }\n            authorAssociation\n          }\n        }\n      }\n    }\n  }\n}",
      "variables": {
        "after": null,
        "name": "openai-agents-python",
        "number": 2232,
        "owner": "openai"
      }
    },
    "headers": {
      "Accept": "application/vnd.github+json",
      "Content-Type": "application/json",
      "X-GitHub-Api-Version": "2022-11-28"
    },
    "method": "POST",
    "url": "https://api.github.com/graphql"
  },
  "response": {
    "headers": {
      "access-control-allow-origin": "*",
      "access-control-expose-headers": "ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Resource, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, X-GitHub-SSO, X-GitHub-Request-Id, Deprecation, Sunset",
      "content-length": "12553",
      "content-security-policy": "default-src 'none'",
      "content-type": "application/json; charset=utf-8",
      "date": "Tue, 20 Jan 2026 04:54:04 GMT",
      "github-authentication-token-expiration": "2026-02-19 04:41:20 UTC",
      "referrer-policy": "origin-when-cross-origin, strict-origin-when-cross-origin",
      "server": "github.com",
      "strict-transport-security": "max-age=31536000; includeSubdomains; preload",
      "vary": "Accept-Encoding, Accept, X-Requested-With",
      "x-accepted-oauth-scopes": "repo",
      "x-content-type-options": "nosniff",
      "x-frame-options": "deny",
      "x-github-media-type": "github.v4; format=json",
      "x-github-request-id": "DAE3:357DBD:15F5611:1EFFE4B:696F0A6B",
      "x-oauth-scopes": "repo",
      "x-ratelimit-limit": "5000",
      "x-ratelimit-remaining": "4906",
      "x-ratelimit-reset": "1768888376",
      "x-ratelimit-resource": "graphql",
      "x-ratelimit-used": "94",
      "x-xss-protection": "0"
    },
    "json": {
      "data": {
        "repository": {
          "issueOrPullRequest": {
            "__typename": "Issue",
            "comments": {
              "nodes": [
                {
                  "author": {
                    "__typename": "User",
                    "avatarUrl": "https://avatars.githubusercontent.com/u/4557?v=4",
                    "databaseId": 4557,
                    "id": "MDQ6VXNlcjQ1NTc=",
                    "login": "ihower",
                    "url": "https://github.com/ihower"
                  },
                  "authorAssociation": "CONTRIBUTOR",
                  "body": "@NateMoneyLion This happens because the model asks to call `fetch_latest_credit_report`, but at that time the tool is not registered on the agent due to `is_enabled=False`. Since the agent no longer has this tool, the SDK raises `agents.exceptions.ModelBehaviorError`.\n\nIn fact, I can’t reproduce this issue with OpenAI models. If the function schema is not provided, OpenAI models usually do not try to call that function.\n\nHowever, other models behave differently. I can reproduce the same issue with Gemini 2.5 Pro: https://gist.github.com/ihower/39435370e337c03c0ef92dffd42f9af4\n\nSo this looks like a model behavior issue. The model seems to remember that the function appeared earlier in the conversation and assumes it is always available, even when it is no longer exposed.\n\nYou can try switching to a different model, or adjusting your prompt to make the model avoid calling functions that may not exist.",
                  "createdAt": "2025-12-24T09:11:00Z",
                  "databaseId": 3689191065,
                  "id": "IC_kwDOOGidp87b5JaZ",
                  "updatedAt": "2025-12-24T09:11:00Z",
                  "url": "https://github.com/openai/openai-agents-python/issues/2232#issuecomment-3689191065"
                },
                {
                  "author": {
                    "__typename": "User",
                    "avatarUrl": "https://avatars.githubusercontent.com/u/136307221?v=4",
                    "databaseId": 136307221,
                    "id": "U_kgDOCB_iFQ",
                    "login": "NateMoneyLion",
                    "url": "https://github.com/NateMoneyLion"
                  },
                  "authorAssociation": "NONE",
                  "body": "oooh, I'll have a try then.\n\nOne thing to note, I did a bit of logging and saw that the `fetch _latest_credit_report` tool was available\n```\nAvailable tools: ['fetch_latest_credit_report', ...]\n```\n\nHowever, in the error log, it outputs it as\n```\nagents.exceptions.ModelBehaviorError: Tool fetch_latest_credit_report\" /> not found in agent Credit Monitoring Agent\n```\n\nNote that the tool name in the error is `fetch_latest_credit_report \" />`. I don't know if this is how the error log should look or if there is a corruption in name-parsing ",
                  "createdAt": "2025-12-26T03:44:43Z",
                  "databaseId": 3692024219,
                  "id": "IC_kwDOOGidp87cD9Gb",
                  "updatedAt": "2025-12-26T04:02:30Z",
                  "url": "https://github.com/openai/openai-agents-python/issues/2232#issuecomment-3692024219"
                },
                {
                  "author": {
                    "__typename": "User",
                    "avatarUrl": "https://avatars.githubusercontent.com/u/4557?v=4",
                    "databaseId": 4557,
                    "id": "MDQ6VXNlcjQ1NTc=",
                    "login": "ihower",
                    "url": "https://github.com/ihower"
                  },
                  "authorAssociation": "CONTRIBUTOR",
                  "body": "@NateMoneyLion The SDK does not change the tool name.\n\nThis is likely because the model you are using does not support function calling very well, so it returned this incorrect name.",
                  "createdAt": "2025-12-26T07:19:57Z",
                  "databaseId": 3692328707,
                  "id": "IC_kwDOOGidp87cFHcD",
                  "updatedAt": "2025-12-26T07:19:57Z",
                  "url": "https://github.com/openai/openai-agents-python/issues/2232#issuecomment-3692328707"
                },
                {
                  "author": {
                    "__typename": "User",
                    "avatarUrl": "https://avatars.githubusercontent.com/u/136307221?v=4",
                    "databaseId": 136307221,
                    "id": "U_kgDOCB_iFQ",
                    "login": "NateMoneyLion",
                    "url": "https://github.com/NateMoneyLion"
                  },
                  "authorAssociation": "NONE",
                  "body": "I've been testing out Claude Sonnet (jumping between 4 and 4.5) so I don't know if this is an edge case. \nOddly, after trying a lot more, oddly, the tool error comes and goes even with the same query.\n\nI'll try with the OpenAI models. ",
                  "createdAt": "2025-12-26T07:34:47Z",
                  "databaseId": 3692352090,
                  "id": "IC_kwDOOGidp87cFNJa",
                  "updatedAt": "2025-12-26T07:34:47Z",
                  "url": "https://github.com/openai/openai-agents-python/issues/2232#issuecomment-3692352090"
                },
                {
                  "author": {
                    "__typename": "User",
                    "avatarUrl": "https://avatars.githubusercontent.com/u/4557?v=4",
                    "databaseId": 4557,
                    "id": "MDQ6VXNlcjQ1NTc=",
                    "login": "ihower",
                    "url": "https://github.com/ihower"
                  },
                  "authorAssociation": "CONTRIBUTOR",
                  "body": "@NateMoneyLion If you’re using Claude Sonnet, it shouldn’t return a malformed tool name. If you can share a minimal reproducible code, I can help take another look.",
                  "createdAt": "2025-12-26T10:51:51Z",
                  "databaseId": 3692688404,
                  "id": "IC_kwDOOGidp87cGfQU",
                  "updatedAt": "2025-12-26T10:51:51Z",
                  "url": "https://github.com/openai/openai-agents-python/issues/2232#issuecomment-3692688404"
                },
                {
                  "author": {
                    "__typename": "User",
                    "avatarUrl": "https://avatars.githubusercontent.com/u/136307221?v=4",
                    "databaseId": 136307221,
                    "id": "U_kgDOCB_iFQ",
                    "login": "NateMoneyLion",
                    "url": "https://github.com/NateMoneyLion"
                  },
                  "authorAssociation": "NONE",
                  "body": "@ihower ironically, it is the code that you've tested with for Gemini. Let me just paste my exact implementation\n\n```\nimport copy\nimport json\nimport uuid\nfrom typing import Optional\nfrom uuid import UUID\n\nfrom agents import (\n    Agent,\n    ModelSettings,\n    OpenAIChatCompletionsModel,\n    RunContextWrapper,\n    Runner,\n)\nfrom openai import AsyncOpenAI\n\nfrom src.agent.tools import (\n    fetch_credit_history,\n    fetch_latest_credit_age_data,\n    fetch_latest_credit_inquiries_data,\n    fetch_latest_credit_report,\n    fetch_latest_credit_utilization_data,\n    fetch_latest_payment_history_data,\n)\n\nfrom src.schemas.request import AgentContext, AgentResponse\n\n\nclass CreditAgent:\n    \"\"\"Custom Agent for credit insights\"\"\"\n\n    def __init__(self, litellm_api_key: str, litellm_api_base: str):\n        # attributes\n        self.service_name = \"Credit Monitoring Agent\"\n        self.llm_model = \"bedrock-claude4.5-sonnet-120s\"\n        self.instructions = \"\n        self.tools = [\n            fetch_latest_credit_report,\n            fetch_credit_history,\n            fetch_latest_credit_utilization_data,\n            fetch_latest_credit_age_data,\n            fetch_latest_credit_inquiries_data,\n            fetch_latest_payment_history_data,\n        ]\n\n        # infra\n        self.litellm_api_key = litellm_api_key\n        self.litellm_api_base = litellm_api_base\n\n        # initialize agent\n        self._init_agent()\n\n    def __get_openai_client(self) -> AsyncOpenAI:\n        \"\"\"Initialize and return the OpenAI client.\"\"\"\n        return AsyncOpenAI(\n            api_key=self.litellm_api_key,\n            base_url=self.litellm_api_base,\n            max_retries=0,\n        )\n\n    def _dynamic_instructions(\n        self, ctx: RunContextWrapper[AgentContext], agent: Agent[AgentContext]\n    ) -> str:\n        \"\"\"\n        Dynamic instructions that incorporate user context.\n        Called at runtime before each agent invocation.\n        \"\"\"\n        if ctx.context.custom_system_prompt:\n            return ctx.context.custom_system_prompt\n\n        return self.instructions\n\n    def _init_agent(self):\n\n        llm = OpenAIChatCompletionsModel(\n            model=self.llm_model,\n            openai_client=self.__get_openai_client(),\n        )\n\n        self._agent = Agent[AgentContext](\n            name=self.service_name,\n            instructions=self._dynamic_instructions,  # Pass the method as a callable\n            model=llm,\n            model_settings=ModelSettings(\n                temperature=0.0,\n                extra_body={\"cache\": {\"no-cache\": True, \"no-store\": True}},\n                tool_choice=\"auto\",\n            ),\n            tools=self.tools,\n        )\n\n    def _augment(self, input: str, message_history: list) -> str:\n        \"\"\"\n        Augment the prompt with additional context or information.\n\n        In this case, it is augmenting the user's input with message_history (if it exists).\n        \"\"\"\n        # consolidate message history (if there is any) and user input to be passed to Agent\n        if message_history:\n            copy__message_history = copy.deepcopy(message_history)\n            copy__message_history.append({\"role\": \"user\", \"content\": input})\n            return copy__message_history\n        else:\n            return [{\"role\": \"user\", \"content\": input}]\n\n    async def ask_agent(\n        self,\n        question: str,\n        user_id: str | None = None,\n        context: AgentContext | None = None,\n        session_id: Optional[UUID] = None,\n    ) -> AgentResponse:\n        \"\"\"\n        Ask the agent a question , if session_id is not provided, a new session will be created.\n        \"\"\"\n        if not session_id:\n            session_id = uuid.uuid4()\n\n        if context is None:\n            context = AgentContext(user_id=user_id)\n\n        # insert user_id into AgentContext since it is needed by tools\n        context.user_id = user_id\n\n        # strip the question of whitespaces before starting\n        question = question.strip()\n\n        message_history = []\n\n        user_data = {}\n\n        context.is_cm_enrolled = True/False (can just hardcode for now)\n\n        # check message history before conversation\n        print(f\"Before conversation message history:\\n{message_history}\")\n\n        # prepare message history + user question to be passed into the agent\n        input = self._augment(input=question, message_history=message_history)\n        # check formatted input\n        print(f\"Formatted input:\\n{input}\")\n\n        agent_response = await Runner.run(\n            starting_agent=self._agent,\n            input=input,\n            context=context,\n        )\n\n        print(f\"Final output:\\n{agent_response.final_output}\")\n\n        return AgentResponse(result=agent_response.final_output, session_id=session_id)\n```\n\n\nI've omitted any message history saving logic at the moment",
                  "createdAt": "2025-12-29T03:31:23Z",
                  "databaseId": 3695346180,
                  "id": "IC_kwDOOGidp87cQoIE",
                  "updatedAt": "2025-12-29T03:31:23Z",
                  "url": "https://github.com/openai/openai-agents-python/issues/2232#issuecomment-3695346180"
                },
                {
                  "author": {
                    "__typename": "User",
                    "avatarUrl": "https://avatars.githubusercontent.com/u/4557?v=4",
                    "databaseId": 4557,
                    "id": "MDQ6VXNlcjQ1NTc=",
                    "login": "ihower",
                    "url": "https://github.com/ihower"
                  },
                  "authorAssociation": "CONTRIBUTOR",
                  "body": "@NateMoneyLion One thing I noticed that may be related: you are actually using `OpenAIChatCompletionsModel`, not `LiteLLMModel`.\n\n`OpenAIChatCompletionsModel` uses Claude’s Chat Completions API (https://platform.claude.com/docs/en/api/openai-sdk). And this API does not return thought data. Because of that, the model cannot receive reasoning tokens during the same turn of function calling. This may make function calling behave less reliably.",
                  "createdAt": "2026-01-05T15:26:41Z",
                  "databaseId": 3710892815,
                  "id": "IC_kwDOOGidp87dL7sP",
                  "updatedAt": "2026-01-05T15:26:41Z",
                  "url": "https://github.com/openai/openai-agents-python/issues/2232#issuecomment-3710892815"
                },
                {
                  "author": {
                    "__typename": "User",
                    "avatarUrl": "https://avatars.githubusercontent.com/u/136307221?v=4",
                    "databaseId": 136307221,
                    "id": "U_kgDOCB_iFQ",
                    "login": "NateMoneyLion",
                    "url": "https://github.com/NateMoneyLion"
                  },
                  "authorAssociation": "NONE",
                  "body": "ahhh, that didn't come across my mind. Thanks for the heads up, I'll apply that change too.",
                  "createdAt": "2026-01-06T12:28:04Z",
                  "databaseId": 3714524641,
                  "id": "IC_kwDOOGidp87dZyXh",
                  "updatedAt": "2026-01-06T12:28:04Z",
                  "url": "https://github.com/openai/openai-agents-python/issues/2232#issuecomment-3714524641"
                },
                {
                  "author": {
                    "__typename": "Bot",
                    "avatarUrl": "https://avatars.githubusercontent.com/in/15368?v=4",
                    "databaseId": 41898282,
                    "id": "MDM6Qm90NDE4OTgyODI=",
                    "login": "github-actions",
                    "url": "https://github.com/apps/github-actions"
                  },
                  "authorAssociation": "CONTRIBUTOR",
                  "body": "This issue is stale because it has been open for 7 days with no activity.",
                  "createdAt": "2026-01-14T02:12:59Z",
                  "databaseId": 3747370982,
                  "id": "IC_kwDOOGidp87fXFfm",
                  "updatedAt": "2026-01-14T02:12:59Z",
                  "url": "https://github.com/openai/openai-agents-python/issues/2232#issuecomment-3747370982"
                },
                {
                  "author": {
                    "__typename": "Bot",
                    "avatarUrl": "https://avatars.githubusercontent.com/in/15368?v=4",
                    "databaseId": 41898282,
                    "id": "MDM6Qm90NDE4OTgyODI=",
                    "login": "github-actions",
                    "url": "https://github.com/apps/github-actions"
                  },
                  "authorAssociation": "CONTRIBUTOR",
                  "body": "This issue was closed because it has been inactive for 3 days since being marked as stale.",
                  "createdAt": "2026-01-18T02:13:20Z",
                  "databaseId": 3764697252,
                  "id": "IC_kwDOOGidp87gZLik",
                  "updatedAt": "2026-01-18T02:13:20Z",
                  "url": "https://github.com/openai/openai-agents-python/issues/2232#issuecomment-3764697252"
                }
              ],
              "pageInfo": {
                "endCursor": "Y3Vyc29yOnYyOpHO4GS4pA==",
                "hasNextPage": false
              }
            }
          }
        }
      }
    },
    "status": 200
  },
  "started_at": "2026-01-20T04:54:03.756080Z"
}
